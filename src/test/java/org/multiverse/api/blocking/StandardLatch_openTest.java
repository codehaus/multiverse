package org.multiverse.api.blocking;

import org.junit.Test;

import static org.junit.Assert.assertEquals;
import static org.multiverse.TestUtils.assertClosed;
import static org.multiverse.TestUtils.assertOpen;

public class StandardLatch_openTest {
    
     @Test
    public void whenAlreadyOpenAndDifferentEra() {
        StandardLatch latch = new StandardLatch();
        long era = latch.getEra();
        latch.open(era);

        latch.open(era + 1);

        assertEquals(era, latch.getEra());
        assertOpen(latch);
    }

    @Test
    public void whenAlreadyOpenAndSameEra() {
        StandardLatch latch = new StandardLatch();
        long era = latch.getEra();
        latch.open(era);

        latch.open(era);

        assertEquals(era, latch.getEra());
        assertOpen(latch);
    }

    @Test
    public void whenClosedAndDifferentEra() {
        StandardLatch latch = new StandardLatch();
        long era = latch.getEra();

        latch.open(era + 1);

        assertEquals(era, latch.getEra());
        assertClosed(latch);
    }

    @Test
    public void whenClosedAndSameEra() {
        StandardLatch latch = new StandardLatch();
        long era = latch.getEra();

        latch.open(era);

        assertEquals(era, latch.getEra());
        assertOpen(latch);
    }
}
