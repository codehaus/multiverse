<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head><title>Multiverse - Java based Software Transactional Memory implementation</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="style.css" type="text/css"/>

    <!-- start of google analytics stuff -->
    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
    </script>
    <script type="text/javascript">
        _uacct = "UA-2882464-1";
        urchinTracker();
    </script>
    <!-- end of google analytics stuff -->
</head>
<body>

<div id="main-header">
    <div>
        <h1 class="main-header-left">Java based Software Transactional Memory implementation</h1>
        <hr class="hide"/>
    </div>
</div>

<div id="header">
    <div id="header-title">
        <h1>Multiverse</h1>

        <p>Founded by Peter Veentjer</p>
    </div>
    <!-- div id="header-logo" -->
    <!-- a id="header-logo" href="http://www.codehaus.org">codehaus.org</a -->
    <!-- /div -->
    <hr class="hide"/>
</div>

<div id="content">
    <div id="side">
        
        <div class="nav-title">
            <div><h3>Menu</h3></div>
        </div>
        <ul class="nav">
            
            <li><a class="unselected" href="overview.html">Overview</a></li>
            
            
            <li><a class="unselected" href="download.html">Download</a></li>
            
            
            <li><a class="unselected" href="features.html">Features</a></li>
            
            
            <li><a class="unselected" href="missionstatement.html">Mission Statement</a></li>
            
            
            <li><a class="unselected" href="nosql.html">NoSQL</a></li>
            
            
            <li><a class="unselected" href="team.html">Team</a></li>
            
            
            <li><a class="unselected" href="http://pveentjer.wordpress.com">Blog</a></li>
            
            
            <li><a class="unselected" href="development.html">Development</a></li>
            
            
            <li><a class="unselected" href="http://pveentjer.wordpress.com">Blog</a></li>
            
            
            <li><a class="unselected" href="license.html">License</a></li>
            
            
        </ul>
        <div class="nav-footer">
            <div></div>
        </div>
        <hr class="hide"/>
        
        <div class="nav-title">
            <div><h3>Documentation</h3></div>
        </div>
        <ul class="nav">
            
            <li><a class="unselected" href="documentationoverview.html">Overview</a></li>
            
            
            <li><a class="unselected" href="manual.html">Reference Manual</a></li>
            
            
            <li><a class="unselected" href="https://linktojavadoc">Javadoc</a></li>
            
            
        </ul>
        <div class="nav-footer">
            <div></div>
        </div>
        <hr class="hide"/>
        
    </div>

    <div id="mainContent">
        <h1>6 Api</h1>

<ul>
    <li><a href="#introduction">6.1 Introduction</a></li>
    <li><a href="#transaction">6.2 Transaction</a>
        <ul>
            <li><a href="#transactionconfig">6.2.1 TransactionConfig</a></li>
            <li><a href="#transactionconfig">6.2.2 No support for opening for read or write</a></li>
        </ul>
    </li>
    <li><a href="#transactionfactory">6.3 TransactionFactory</a></li>
    <li><a href="#transactionfactorybuilder">6.4 TransactionFactoryBuilder</a></li>
    <li><a href="#transactionfactorybuilder">6.5 Stm</a></li>
    <li><a href="#threadlocaltransaction">6.6 ThreadLocalTransaction</a></li>
    <li><a href="#globalstminstance">6.7 GlobalStmInstance</a></li>
    <li><a href="#multiverse.transactional.package">6.8 Multiverse transactional package</a></li>
    <li><a href="#multiverse.util.package">6.8 Multiverse util package</a>
        <ul>
            <li><a href="#clock">6.8.1 Clock</a></li>
            <li><a href="#commitlock">6.8.2 CommitLock</a></li>
            <li><a href="#clock">6.8.2 RestartBackoffPolicy</a></li>
        </ul>
    </li>
</ul>

<h2 id="introduction">6.1 Introduction</h2>
If you are using instrumentation, chances are high that you don't need to deal with the core api's of Multiverse
        directly. But if you want to implement custom STM's using Multiverse, want to integrate it in a different
        language, or just want to have a better understanding; the Multiverse API is the best place to begin.

<h2 id="transaction">6.2 Transaction</h2>
        One of the most central parts of Multiverse is the Transaction. It exposes functionality for:
<ol>
    <li><b>committing:</b> to commit the pending changes or abort the transaction it the commit failed (
    for example caused by a writeconflict)</li>
    <li><b>aborting:</b> to abort a transaction and prevent the changes from being committed. If a transaction
        already is committed, it can't be aborted (you'll get a DeadTransactionException).
    </li>
    <li>
        <b>resetting:</b> to make it possible that the same transaction instance can be reused. This is very
        useful if there read/write conflicts and you want to reuse the instance. By resetting it, it can be
        reused for another try.
    </li>
    <li>
        <b>transactionlifecyclelisteners:</b> to make it possible to listen to certain transaction lifecycle events
        like postcommit or postabort. For more information check
        <a href="manual-lifecycleevents.html">chapter 3 Transaction lifecycle events</a>
    </li>
</ol>
<p/>

<h3 id="">No support for opening for read or write</h3>
The transaction is responsible for
        tracking all writes that have been done (and in some cases also the reads) and also providing the transactional
        properties like isolation and failure atomicity.
But it doesn't expose methods for opening transactional objects. After a lot
        of experimentations and a few complete rewrites of AlphaStm (the main Stm implementation) I decided that
        these methods are so implementation specific that placing them in the Transaction interface only is
        going to limit reusability.

<h3 id="transactionConfig">TransactionConfig</h3>
It also exposes functionality for the configuration of transaction through the TransactionConfig. In the beginning
        all these properties were placed on the Transaction interface directly but it make a messy interface. That is
        why it was moved to a Config object that only contains configuration properties.

<h2 id="transactionfactory">6.3 TransactionFactory</h2>
        It isn't possible to create transactions directly, they should always be created with a TransactionFactory.
        A TransactionFactory should create Transactions optimal configured for certain scenario's. For more information
        check <a href="#transactionFactoryBuilder">TransactionFactoryBuilder</a>

<p/>
        TransactionFactories are threadsafe to use and can be expensive to create. So it is best to create them
        in the beginning and store them for later use.


<h2 id="transactionfactorybuilder">6.4 TransactionFactoryBuilder</h2>
        The transaction factory always returns transactions with the same configuration. But what is the use
        of such a strange beast; what about configuration? This can be done through the transaction factory builder.
        This builder implementation provides ... The TransactionFactoryBuilder is threadsafe and can be reused. But
        in most cases you only want to have TransactionFactories and discard the TransactionFactoryBuilders after the
        TransactionFactories are created.
<p/>
        Make sure that use the return value of the set methods, because that is going to returned the updated
        builder since the TransactionFactoryBuilder is immutable. If this is forgotten, you won't get the
        transaction configured in the way you would expect.

<h2 id="stm">6.5 Stm</h2>
This also brings us to the last missing peace of the puzzel; the STM. The only thing that the STM implementation
needs to do, is to provide TransactionFactoryBuilders.

<h2 id="threadlocaltransaction">6.6 ThreadLocalTransaction</h2>
The ThreadLocalTransaction is a ThreadLocal responsible for storing a Transaction. This functionality is needed for
        the instrumentation process. But if you are directly

<h2 id="globalstminstance">6.7 GlobalStmInstance</h2>
The GlobalStmInstance is responsible for storing the global STM instance. This functionality is needed for the
        instrumented classes, but if you are using the api's directly, you don't need to care about the GlobalStmInstance.
        So if you want you can create more than 1 STM instance, as long as the objects managed by these STM's are not
        shared between them. One of the reasons this could fails is that versions of written data don't make sense and
        no isolation guarantees can be provided anymore.
<p/>
        In the future some form of ThreadLocalStm may be added to make using different STM instances in the same
        JVM easier.

<h2 id="globalstminstance">6.7 Multiverse transactional package</h2>        

<h2 id="multiverse.util.package">6.8 Multiverse util package</h2>
        The org.multiverse.util package contains a lot of support systems that are not tied to a specific
        Stm implementation. So if you want to build your own implementation or want to tweak the AlphaStm,
        this is the place to get started.

<h3 id="clock">Clock</h3>

<h3 id="commitlock">CommitLock</h3>

<h3 id="restart.backoff.policy">Restart backoff policy</h3>
    </div>

    <!-- end of main content -->

    <div id="footer">
        <hr class="hide"/>
        <div id="footer-contents">Last updated: 3 Januari 2010
            <br/>
            Copyright Â© 2010
        </div>
    </div>
</div>
<!-- content -->
</body>
</html>
